#!/usr/bin/env ruby

# Today:
# - [20] Meditation.
# - [20] Dancing.
# - [15] TopTal. #online #work
# - Some cleanup.
# - [90] Write a blog post. #online
# - Plan tomorrow.

require 'pomodoro'
manager = Pomodoro::TaskManager.parse(File.expand_path('~/Dropbox/WIP/tasks.todo'))

case ARGV.shift
when 'work'
  abort "No more tasks." if manager.today_tasks.empty?
  puts %Q{pomodoro #{manager.today_tasks.first.gsub('#', '\#')}}
  %x{pomodoro #{manager.today_tasks.first.gsub('#', '\#')}}
when 'done'
  manager.mark_active_task_as_done
when 'next'
  system "#{$0} done && #{$0} work"
when 'today'
  unless manager.today_tasks.empty?
    puts manager.today_tasks
  else
    puts "All done!"
  end
# TODO: punch-off
else
  abort "Usage: #{$0} [work|done|next|today]."
end
